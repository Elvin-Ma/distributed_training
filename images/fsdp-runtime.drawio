<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.7.17 Chrome/128.0.6613.36 Electron/32.0.1 Safari/537.36" version="24.7.17">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="1434" dy="836" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="6ECefURprO4C8OUo4g8o-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-3" target="6ECefURprO4C8OUo4g8o-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-3" value="_cast_buffers_to_dtype_and_device" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="73" y="235.5" width="205" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-6" target="WIyWlLk6GJQsqaUBKTNV-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-6" target="6ECefURprO4C8OUo4g8o-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-6" value="eval is full&amp;nbsp;&lt;div&gt;precision?&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;shadow=0;fontFamily=Helvetica;fontSize=12;align=center;strokeWidth=1;spacing=6;spacingTop=-4;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="323" y="220.5" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-7" target="6ECefURprO4C8OUo4g8o-0">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-7" value="FSDP:forward" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="573" y="133" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-0" target="6ECefURprO4C8OUo4g8o-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-0" target="WIyWlLk6GJQsqaUBKTNV-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-0" value="_root_pre_forward" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="553" y="228" width="140" height="45" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-2" target="6ECefURprO4C8OUo4g8o-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-2" target="6ECefURprO4C8OUo4g8o-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-2" value="_pre_forward" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="548" y="323" width="150" height="47.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-4" target="6ECefURprO4C8OUo4g8o-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-4" target="6ECefURprO4C8OUo4g8o-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-4" value="compute" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="563" y="440" width="120" height="38.75" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-6" value="_post_forward" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="563" y="546" width="120" height="38.75" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-10" value="_root_cast_forward_input" style="whiteSpace=wrap;html=1;shadow=0;strokeWidth=1;spacing=6;spacingTop=-4;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="314.5" y="314" width="157" height="32.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-14" target="6ECefURprO4C8OUo4g8o-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-14" value="_post_forward_reshard" style="whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="381" y="440" width="143" height="38.75" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-16" value="_register_pre_&lt;div&gt;backward_hook&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="223" y="440" width="123" height="38.75" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-18" value="_pre_backward_hook" style="whiteSpace=wrap;html=1;fillColor=#FF0000;strokeColor=#9673a6;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="52" y="440" width="123" height="38.75" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-20" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-16" target="6ECefURprO4C8OUo4g8o-18">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="503" as="sourcePoint" />
            <mxPoint x="230" y="503" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-21" value="注册" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;" connectable="0" vertex="1" parent="6ECefURprO4C8OUo4g8o-20">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="-13" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-23" target="6ECefURprO4C8OUo4g8o-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-56" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-23" target="6ECefURprO4C8OUo4g8o-55">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-23" value="_pre_forward_unshard" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="740" y="323" width="130" height="47.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-28" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-25" target="6ECefURprO4C8OUo4g8o-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-25" target="6ECefURprO4C8OUo4g8o-29">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="975" y="303" />
              <mxPoint x="805" y="303" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-25" value="_register_post_&lt;div&gt;backward_hook&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="920" y="323" width="110" height="47.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-49" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-27" target="6ECefURprO4C8OUo4g8o-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-27" value="_register_post_backward&lt;div&gt;_reshard_only_hook&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1130" y="326.75" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-34" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-29" target="6ECefURprO4C8OUo4g8o-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-29" value="_post_backward_hook" style="whiteSpace=wrap;html=1;fillColor=#FF0000;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="710" y="228" width="190" height="35" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-32" value="flat_param.expand_as(flat_param).grad_fn.&lt;div&gt;next_functions[0][0].register_hook(_post_backward_hook)&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="807" y="269" width="320" height="32" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-33" target="6ECefURprO4C8OUo4g8o-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-42" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-33" target="6ECefURprO4C8OUo4g8o-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-33" value="_post_backward_reshard" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="725" y="126" width="160" height="35" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-35" target="6ECefURprO4C8OUo4g8o-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-35" value="_reduce_grad" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="747" y="56" width="115" height="35" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-40" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-37" target="6ECefURprO4C8OUo4g8o-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-37" value="dist.reduce_scatter_tensor&lt;div&gt;(对完整的tensor使用reduce)&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="901" y="58" width="158" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-39" value="flat_param._saved_grad_shard&lt;div&gt;&amp;nbsp;= sharded_grad&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1092" y="58" width="191" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-46" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-41" target="6ECefURprO4C8OUo4g8o-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-41" value="reshard" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="947" y="126" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-43" value="step1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="745" y="100" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-44" value="step2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="888" y="114" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-45" value="_prefetch_handle" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1080" y="126" width="110" height="35" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-48" target="6ECefURprO4C8OUo4g8o-52">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-48" value="prepare_gradient_for_optim" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1130" y="263" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-52" value="flat_param.grad=&lt;div&gt;flat_param._saved_grad_shard&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1126" y="194.5" width="168" height="35" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-59" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-55" target="6ECefURprO4C8OUo4g8o-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-63" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-55" target="6ECefURprO4C8OUo4g8o-62">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-55" value="handle.pre_unshard" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="739.5" y="439.25" width="130" height="39.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-57" value="may be pre_fetch" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="687" y="392" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-61" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-58" target="6ECefURprO4C8OUo4g8o-60">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-58" value="_use_low_precision_shard.&lt;div&gt;copy_(local_shard)&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="910.5" y="439.25" width="160.5" height="39.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-60" value="handle.flat_param.data = _mp_shard" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1125" y="439.25" width="145" height="40.75" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-65" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-62" target="6ECefURprO4C8OUo4g8o-64">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-73" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-62" target="6ECefURprO4C8OUo4g8o-72">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-62" value="handle.unshard" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="739.5" y="520" width="130" height="39.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-67" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-64" target="6ECefURprO4C8OUo4g8o-66">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-64" value="alloca_unsharded_&lt;div&gt;_flat_param&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="913.5" y="520" width="130" height="39.5" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-69" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-66" target="6ECefURprO4C8OUo4g8o-68">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-66" value="all_gather" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1091" y="520" width="80.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-71" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6ECefURprO4C8OUo4g8o-68" target="6ECefURprO4C8OUo4g8o-70">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-68" value="_use_unsharded_views&lt;div&gt;(unflatten)&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1213.5" y="520" width="132.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-70" value="free_mp_shard" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1384" y="520" width="94" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ECefURprO4C8OUo4g8o-72" value="handle.post_unshard" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;glass=0;strokeWidth=1;shadow=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="739.5" y="604.5" width="130" height="39.5" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
